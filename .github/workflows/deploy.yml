name: deploy hugo
on:
  push:
    branches:
      - hugo
jobs:
  deploy:
    if: "!contains(github.event.head_commit.message, 'ci skip')"
    runs-on: ubuntu-20.04
    steps:
      - name: Git checkout
        uses: actions/checkout@v2
      
      - name: install dart-sass-embedded
        # run: sudo wget https://github.com/sass/dart-sass-embedded/releases/download/1.56.1/sass_embedded-1.56.1-linux-x64.tar.gz && sudo tar -xvzf sass_embedded-1.56.1-linux-x64.tar.gz -C /usr/local/bin/; sudo chmod 777 /usr/local/bin/sass_embedded/dart-sass-embedded; export PATH="/usr/local/bin/sass_embedded/dart-sass-embedded:${PATH}"; echo $PATH
        run: sudo wget https://github.com/sass/dart-sass-embedded/releases/download/1.56.1/sass_embedded-1.56.1-linux-x64.tar.gz && sudo tar -xvzf sass_embedded-1.56.1-linux-x64.tar.gz && sudo chmod +x ./sass_embedded/dart-sass-embedded && sudo mv ./sass_embedded/dart-sass-embedded /usr/local/bin && command -v dart-sass-embedded
      - name: Install npm dependencies
        run: yarn install
      
      - name: Build
        uses: jakejarvis/hugo-build-action@v0.89.2
        with:
          args: --minify
